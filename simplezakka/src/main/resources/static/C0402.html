<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>注文確認 - SIMPLE GOODS ONLINE</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .section-title {
      font-size: 1.25rem;
      font-weight: bold;
      margin-top: 30px;
    }
    .confirmation-box {
      background-color: #f9f9f9;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 30px;
    }
  </style>
</head>
<body class="container mt-5 mb-5">

  <h2 class="mb-4">注文内容の確認</h2>

  <!-- 注文商品一覧 -->
  <div class="confirmation-box">
    <div class="section-title">注文商品</div>
    <ul id="order-items" class="list-group"></ul>
    <div class="text-end mt-3">
      <strong>合計金額: <span id="total-amount">¥0</span></strong>
    </div>
  </div>

  <!-- お届け先情報 -->
  <div class="confirmation-box">
    <div class="section-title">お届け先</div>
    <p><strong>氏名:</strong> <span id="confirm-name"></span></p>
    <p><strong>住所:</strong> <span id="confirm-address"></span></p>
    <p><strong>メールアドレス:</strong> <span id="confirm-email"></span></p>
    <p><strong>電話番号:</strong> <span id="confirm-phone"></span></p>
  </div>

  <!-- 支払い方法 -->
  <div class="confirmation-box">
    <div class="section-title">お支払い方法</div>
    <p id="confirm-payment"></p>
  </div>

  <div class="text-end">
    <button class="btn btn-secondary" onclick="history.back()">戻る</button>
    <button class="btn btn-primary" id="final-confirm-btn">注文を確定する</button>
  </div>

  <!-- 注文完了モーダル -->
  <div class="modal fade" id="orderCompleteModal" tabindex="-1" aria-labelledby="orderCompleteLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="orderCompleteLabel">注文完了</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="閉じる"></button>
        </div>
        <div class="modal-body" id="orderCompleteBody">
          <!-- 注文完了メッセージがmain.jsから挿入される -->
        </div>
        <div class="modal-footer">
          <a href="index.html" class="btn btn-primary">トップページに戻る</a>
        </div>
      </div>
    </div>
  </div>

  <script>
    const orderData = {
      items: JSON.parse(sessionStorage.getItem('order_items') || '[]'),
      total: parseInt(sessionStorage.getItem('order_total') || '0'),
      name: sessionStorage.getItem('order_name') || '',
      email: sessionStorage.getItem('order_email') || '',
      address: sessionStorage.getItem('order_address') || '',
      phone: sessionStorage.getItem('order_phone') || '',
      payment: sessionStorage.getItem('order_payment') || ''
    };

    const paymentMap = {
      credit_card: 'クレジットカード',
      bank_transfer: '銀行振込',
      cash_on_delivery: '代金引換'
    };

    const itemsContainer = document.getElementById('order-items');
    orderData.items.forEach(item => {
      const subtotal = item.quantity * item.price;
      const li = document.createElement('li');
      li.className = 'list-group-item d-flex justify-content-between align-items-center';
      li.innerHTML = `<div>${item.name} × ${item.quantity}</div><div>¥${subtotal.toLocaleString()}</div>`;
      itemsContainer.appendChild(li);
    });

    document.getElementById('total-amount').textContent = `¥${orderData.total.toLocaleString()}`;
    document.getElementById('confirm-name').textContent = orderData.name;
    document.getElementById('confirm-email').textContent = orderData.email;
    document.getElementById('confirm-address').textContent = orderData.address;
    document.getElementById('confirm-phone').textContent = orderData.phone;
    document.getElementById('confirm-payment').textContent = paymentMap[orderData.payment] || '未指定';
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="main.js"></script>
</body>
</html>
