
=======
## 3. 機能設計

### 3.1 機能一覧（ID付）

| 機能ID    | 機能名                     | 画面ID                | 機能概要                                         |
|------------|----------------------------|-----------------------|--------------------------------------------------|
| F0101      | トップページ表示           | C0101                 | サイトのトップページを表示する                   |
| F0201      | 商品一覧表示               | C0201                 | 商品の一覧情報を表示する                         |
| F0202      | 商品詳細表示               | C0202                 | 選択した商品の詳細情報を表示する                 |
| F0301      | カート操作                 | C0301                 | カート内商品の確認・編集                         |
| F0401      | 注文情報入力               | C0401                 | 配送先や支払い方法の入力画面                     |
| F0402      | 注文確認                   | C0402                 | 入力内容の最終確認画面                           |
| F0403      | 注文完了                   | C0403                 | 注文完了メッセージ表示                           |
| F0501      | 会員登録                   | C0501                 | 新規会員登録機能（会員情報入力）                 |
| F0502      | 会員情報変更               | C0501                 | 会員情報の変更機能 (会員登録）                   |
| F0601      | ログイン                   | C0601                 | 顧客ログイン機能                                 |
| F0602      | ログアウト                 | -                     | 顧客ログアウト機能                               |
| F0603      | マイページ表示             | C0603                 | 会員情報や登録情報の表示                         |
| F0604      | 注文履歴表示               | C0604                 | 過去の注文履歴を表示                             |
| F0605      | 購入前ログイン             | C0605                 | ログイン、新規登録、ゲストで購入を選択           |
| F0701      | 特定商取引法表示           | C0701                 | 特商法に基づく表記の表示                         |
| F0801      | プライバシーポリシー表示   | C0801                 | プライバシーポリシーの表示                       |
| F0901      | FAQ表示                    | C0901                 | よくある質問の表示                               |
| F1001      | 共通エラーページ表示       | C1001                 | 404・サーバーエラー時の表示                      |
| F1101      | 自動入力                   | -                     | 自動入力機能                                     |
| F1201      | 注文確定メール通知（銀行口座） | -                 | 注文確定メール通知（銀行口座情報含む）           |

---

### 3.2 機能構成図

#### 3.2.1【顧客向け機能】

F0101 トップページ表示
├─ F0201 商品一覧表示
│ └─ F0202 商品詳細表示
│ └─ F0301 カート操作
├─ F0301 カート操作
├─ F0605 購入前ログイン（非ログイン時）
│ ├─ F0601 ログイン → F0401 注文情報入力
│ ├─ F0501 会員登録 → F0401 注文情報入力
│ └─ F0401 注文情報入力
├─ F0401 注文情報入力（ログイン時）
│ └─ F1101 自動入力
├─ F0402 注文確認
│ └─ F1201 注文確定メール通知
├─ F0403 注文完了
├─ F0501 会員登録
├─ F0601 ログイン
│ ├─ F0603 マイページ表示
│ │ ├─ F0502 会員情報変更
│ │ │ └─ F1101 自動入力（変更時に反映）
│ │ └─ F0604 注文履歴表示
│ └─ F0602 ログアウト
├─ F0701 特定商取引法表示
├─ F0801 プライバシーポリシー表示
├─ F0901 FAQ表示
└─ F1001 共通エラーページ表示


---

### 3.3 主要機能フロー（画面）

#### 3.3.1 購入フロー

```mermaid
sequenceDiagram
    participant ユーザー
    participant Webサイト
    participant データベース
    participant メールサーバ

    ユーザー ->> Webサイト: F0101 トップページ表示
    Webサイト ->> データベース: 商品情報取得
    データベース -->> Webサイト: 商品情報一覧

    ユーザー ->> Webサイト: F0201 商品一覧表示
    ユーザー ->> Webサイト: F0202 商品詳細表示
    Webサイト ->> データベース: 商品詳細情報取得
    データベース -->> Webサイト: 商品詳細情報

    ユーザー ->> Webサイト: F0301 カート操作

    alt 非ログインユーザー
        Webサイト ->> ユーザー: F0605 購入前ログインを要求
        alt ユーザーが「ログイン」選択
            ユーザー ->> Webサイト: F0601 ログイン
            Webサイト ->> データベース: 認証情報確認
            データベース -->> Webサイト: 認証結果・会員情報
            ユーザー ->> Webサイト: F0401 注文情報入力
        else ユーザーが「会員登録」選択
            ユーザー ->> Webサイト: F0501 会員登録
            Webサイト ->> データベース: 会員情報登録
            データベース -->> Webサイト: 登録完了
            ユーザー ->> Webサイト: F0401 注文情報入力
        else ユーザーが「非会員として購入」選択
            ユーザー ->> Webサイト: F0401 注文情報入力
        end
    else ログイン済みユーザー
        ユーザー ->> Webサイト: F0401 注文情報入力
        Webサイト ->> データベース: 会員情報取得
        データベース -->> Webサイト: 会員情報
    end

    alt ログイン済み or 会員登録済み
        Webサイト ->> Webサイト: F1101 自動入力（会員情報）
    end

    ユーザー ->> Webサイト: F0402 注文確認
    Webサイト ->> データベース: 注文情報登録
    データベース -->> Webサイト: 登録結果（注文IDなど）

    Webサイト ->> メールサーバ: F1201 注文確定メール通知（銀行口座）

#### 3.3.2 会員登録・ログインフロー

```mermaid
sequenceDiagram
    participant ユーザー
    participant Webサイト
    participant データベース

    %% 会員登録
    ユーザー ->> Webサイト: F0501 会員登録
    Webサイト ->> データベース: ユーザー情報登録
    データベース -->> Webサイト: 登録結果（成功／失敗）

    %% ログイン
    ユーザー ->> Webサイト: F0601 ログイン
    Webサイト ->> データベース: 認証リクエスト（メール・パスワード）
    データベース -->> Webサイト: 認証結果（OK／NG）

    %% マイページ表示
    ユーザー ->> Webサイト: F0603 マイページ表示
    Webサイト ->> データベース: 会員情報取得（ユーザーID）
    データベース -->> Webサイト: 会員情報（名前、メール、住所など）

    %% 会員情報変更
    ユーザー ->> Webサイト: F0502 会員情報変更
    Webサイト ->> Webサイト: F1101 自動入力（現在会員情報）
    Webサイト ->> データベース: 会員情報更新要求
    データベース -->> Webサイト: 更新結果（成功／失敗）

    %% 注文履歴表示
    ユーザー ->> Webサイト: F0604 注文履歴表示
    Webサイト ->> データベース: 注文履歴取得（ユーザーID）
    データベース -->> Webサイト: 注文履歴一覧データ

    %% ログアウト
    ユーザー ->> Webサイト: F0602 ログアウト
    Webサイト -->> ユーザー: ログアウト完了
---
